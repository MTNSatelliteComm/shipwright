{
    "num_instances": 1,
    "vm": {
        "driver": {
            "drivertype": "cloudformation",
            "driveroptions": [
                {
                    "access_key_id": "<%= aws_key_id %>",
                    "secret_access_key": "<%= aws_secret %>",
                    "template_file": "template.json",
                    "template_parameters": {
                        "InstanceType": "m1.large",
                        "KeyName": "<%= aws_keypair %>",
                        "ShipName": "<%= ship_name %>",
                        "ChefEnvironment": "<%= chef_env %>",
                        "Infra1PublicIp": "<%= public_ip_alloc_id %>",
                        "S3ChefBucket": "<%= aws_bucket %>",
                        "Validator": "<%= validator_client %>"
                    },
                    "rabbit": {
                        "bunny_params": {
                            "host": "<%= rabbit_host %>",
                            "port": "<%= rabbit_port %>",
                            "user": "<%= rabbit_user %>",
                            "pass": "<%= rabbit_pass %>",
                            "vhost": "<%= rabbit_vhost %>"
                        },
                        "queue": {
                            "name": "<%= rabbit_queue %>",
                            "params": {
                                "durable": true
                            }
                        },
                        "exchange": {
                            "name": "<%= rabbit_exchange %>",
                            "params": {
                                "durable": true
                            }
                        },
                        "event_timestamp_name": "@timestamp"
                    },
                    "storage": {
                        "s3_bucket": {
                            "name": "<%= aws_bucket %>",
                            "public": false,
                            "files": [ 
                                "chef_init.rb",
                                "validation.pem",
                                "serf.conf",
                                "ec2.json",
                                "serf_infra1.json",
                                "serf_sled2.json",
                                "serf_sled3.json",
                                "serf_sled4.json",
                                "serf_sled5.json",
                                "serf_sled6.json",
                                "serf_sled7.json",
                                "serf_sled8.json"
                            ]
                        }
                    }
                }
            ]
        },
        "instances": [],
        "additional_files": [
            {
                "from": "chef_init.rb",
                "to": "chef_init.rb"
            },
            {
                "from": "<%= validator_path %>",
                "to": "validation.pem"
            },
            {
                "from": "template.json",
                "to": "template.json"
            },
            {
                "from": "serf.conf",
                "to": "serf.conf"
            },
            {
                "from": "ec2.json",
                "to": "ec2.json"
            },
            {
                "from": "serf_infra1.json",
                "to": "serf_infra1.json"
            },
            {
                "from": "serf_sled2.json",
                "to": "serf_sled2.json"
            },
            {
                "from": "serf_sled3.json",
                "to": "serf_sled3.json"
            },
            {
                "from": "serf_sled4.json",
                "to": "serf_sled4.json"
            },
            {
                "from": "serf_sled5.json",
                "to": "serf_sled5.json"
            },
            {
                "from": "serf_sled6.json",
                "to": "serf_sled6.json"
            },
            {
                "from": "serf_sled7.json",
                "to": "serf_sled7.json"
            },
            {
                "from": "serf_sled8.json",
                "to": "serf_sled8.json"
            }
        ]
    }
}